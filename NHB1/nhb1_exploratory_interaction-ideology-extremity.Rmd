---
title: 'Exploratory Analyses NHB1: Interaction between Ideology and Ideological Extremity'
author: "Youssef Amin and Angelika Stefan"
output: html_document
---

## Load packages

```{r setup}
library(brms)
library(bayestestR)
library(Bayesrel)
library(knitr)
```

## Read in and combine data from Prolific and MTurk

```{r}
# Read in data from both studies
nhb1a <- read.csv('../../data/nhb1a_processed.csv')
nhb1b <- read.csv('../../data/nhb1b_processed.csv')

nhb1a$platform <- "Prolific"
nhb1b$platform <- "MTurk"

# Combine data
nhb1 <- rbind(nhb1a, nhb1b)

# Compute standardized scores for political extremity in the combined dataset
nhb1$z_PolOrientExtremity <- scale(nhb1$PolOrientExtremity)
nhb1$z_SocOrientExtremity <- scale(nhb1$SocOrientExtremity)
nhb1$z_EconOrientExtremity <- scale(nhb1$EconOrientExtremity)
nhb1$z_SECSExtremity <- scale(nhb1$SECSExtremity)
nhb1$composite_ideological_extremity <- rowMeans(nhb1[, c("z_PolOrientExtremity", "z_SocOrientExtremity", "z_EconOrientExtremity", "z_SECSExtremity")], na.rm = TRUE)
nhb1$composite_ideological_extremity_z <- scale(nhb1$composite_ideological_extremity)

# Compute standardized scores for mean intergroup bias in the combined dataset
nhb1$z_total_ingroup_minus_outgroup_points <- scale(nhb1$total_ingroup_minus_outgroup_points)
nhb1$z_ingroup_minus_outgroup_traits_positive <- scale(nhb1$ingroup_minus_outgroup_traits_positive)
nhb1$z_ingroup_minus_outgroup_identify <- scale(nhb1$ingroup_minus_outgroup_identify)
nhb1$mean_intergroup_bias <- rowMeans(nhb1[, c("z_total_ingroup_minus_outgroup_points", "z_ingroup_minus_outgroup_traits_positive", "z_ingroup_minus_outgroup_identify")], na.rm = TRUE)
nhb1$mean_intergroup_bias_z <- scale(nhb1$mean_intergroup_bias)

# Compute standardized scores for composite political orientation in the combined dataset
nhb1$z_mean_SECS <- scale(nhb1$mean_SECS)
nhb1$z_EconOrient <- scale(nhb1$EconOrient)
nhb1$z_SocOrient <- scale(nhb1$SocOrient)
nhb1$z_PolOrient <- scale(nhb1$PolOrient)
nhb1$composite_political_orientation <- rowMeans(nhb1[, c("z_mean_SECS", "z_EconOrient", "z_SocOrient", "z_PolOrient")], na.rm = TRUE)
nhb1$composite_political_orientation_z <- scale(nhb1$composite_political_orientation)
```

## Preregistered exploratory analysis

*In separate exploratory analysis, we will also examine the interaction between ideology [sic!] in predicting minimal intergroup bias using the composite intergroup bias measure.*

What was meant here was the interaction between ideology *and ideological extremity*, as computed and reported in the pilot study.

We will compute the analysis in all three samples, following our analysis strategy from the confirmatory analyses. Due to the inadequate internal consistency of the intergroup bias index (see reliability analyses in separate script), we will conduct all analyses with the intergroup bias index, Tajfel points, evaluative traits, and identification ratings as dependent variables.

## Interaction effect for combined measure

### Combined sample

#### Model fitting

```{r}
# Define model equation
exploratory_formula <- mean_intergroup_bias_z ~ composite_ideological_extremity_z * composite_political_orientation_z

# Fit frequentist model
exploratory_freqmodel <- lm(exploratory_formula, nhb1)

# Fit Bayesian model
exploratory_priors <- c(
  set_prior("normal(0, 0.5)", class = "b", coef="composite_political_orientation_z"),
  set_prior("normal(0, 0.5)", class = "b", coef="composite_ideological_extremity_z"),
  set_prior("normal(0, 0.2)", class = "b", coef="composite_ideological_extremity_z:composite_political_orientation_z")
  )

exploratory_bayesmodel <- brms::brm(
  formula = exploratory_formula,
  data = nhb1,
  family = "gaussian",
  prior = exploratory_priors,
  sample_prior = TRUE, 
  iter = 100000,
  chains = 4,
  seed = 987654,
  #silent = TRUE,
  #refresh = 0,
  warmup = 5000,
  file = "./model-fits/nhb1/exploratory5_bayesmodel_extremity"
)
```

#### Model summaries

```{r}
summary(exploratory_freqmodel)
summary(exploratory_bayesmodel)
```

#### Hypothesis test

Frequentist testing quantities

```{r}
# Coefficient estimate
coef2_freq <- exploratory_freqmodel$coefficients["composite_ideological_extremity_z:composite_political_orientation_z"]

# Confidence interval
confint2_freq <- confint(exploratory_freqmodel, "composite_ideological_extremity_z:composite_political_orientation_z")

# p-Value (extracted from model summary for two-sided test)
p_confirm2 <- summary(exploratory_freqmodel)$coefficients["composite_ideological_extremity_z:composite_political_orientation_z","Pr(>|t|)"]

data.frame("beta_z" = round(coef2_freq, 2),
           "CI_lower" = round(confint2_freq[1], 2),
           "CI_upper" = round(confint2_freq[2], 2),
           "p value" = round(p_confirm2, 3))
```

Bayesian testing quantities

```{r}
# Coefficient estimate
coef1_bayes <- fixef(exploratory_bayesmodel)["composite_ideological_extremity_z:composite_political_orientation_z", "Estimate"]

# Credible interval
cred1_bayes <- fixef(exploratory_bayesmodel)["composite_ideological_extremity_z:composite_political_orientation_z", c("Q2.5", "Q97.5")]

# Bayes factor
bf10 <- hypothesis(exploratory_bayesmodel, "composite_ideological_extremity_z:composite_political_orientation_z = 0")

data.frame("beta_z" = round(coef1_bayes, 2),
           "CI_lower" = round(cred1_bayes[1], 2),
           "CI_upper" = round(cred1_bayes[2], 2),
           "BF10" = 1/bf10$hypothesis$Evid.Ratio)
```

### Prolific sample

#### Model fitting

```{r}
# Fit frequentist model
exploratory_freqmodel <- lm(exploratory_formula, nhb1a)

# Fit Bayesian model
exploratory_bayesmodel <- brms::brm(
  formula = exploratory_formula,
  data = nhb1a,
  family = "gaussian",
  prior = exploratory_priors,
  sample_prior = TRUE, 
  iter = 100000,
  chains = 4,
  seed = 987654,
  #silent = TRUE,
  #refresh = 0,
  warmup = 5000,
  file = "./model-fits/nhb1/exploratory5a_bayesmodel_extremity"
)
```

#### Model summaries

```{r}
summary(exploratory_freqmodel)
summary(exploratory_bayesmodel)
```

#### Hypothesis test

Frequentist testing quantities

```{r}
# Coefficient estimate
coef2_freq <- exploratory_freqmodel$coefficients["composite_ideological_extremity_z:composite_political_orientation_z"]

# Confidence interval
confint2_freq <- confint(exploratory_freqmodel, "composite_ideological_extremity_z:composite_political_orientation_z")

# p-Value (extracted from model summary for two-sided test)
p_confirm2 <- summary(exploratory_freqmodel)$coefficients["composite_ideological_extremity_z:composite_political_orientation_z","Pr(>|t|)"]

data.frame("beta_z" = round(coef2_freq, 2),
           "CI_lower" = round(confint2_freq[1], 2),
           "CI_upper" = round(confint2_freq[2], 2),
           "p value" = round(p_confirm2, 3))
```

Bayesian testing quantities

```{r}
# Coefficient estimate
coef1_bayes <- fixef(exploratory_bayesmodel)["composite_ideological_extremity_z:composite_political_orientation_z", "Estimate"]

# Credible interval
cred1_bayes <- fixef(exploratory_bayesmodel)["composite_ideological_extremity_z:composite_political_orientation_z", c("Q2.5", "Q97.5")]

# Bayes factor
bf10 <- hypothesis(exploratory_bayesmodel, "composite_ideological_extremity_z:composite_political_orientation_z = 0")

data.frame("beta_z" = round(coef1_bayes, 2),
           "CI_lower" = round(cred1_bayes[1], 2),
           "CI_upper" = round(cred1_bayes[2], 2),
           "BF10" = 1/bf10$hypothesis$Evid.Ratio)
```

### MTurk sample

#### Model fitting

```{r}
# Fit frequentist model
exploratory_freqmodel <- lm(exploratory_formula, nhb1b)

# Fit Bayesian model
exploratory_bayesmodel <- brms::brm(
  formula = exploratory_formula,
  data = nhb1b,
  family = "gaussian",
  prior = exploratory_priors,
  sample_prior = TRUE, 
  iter = 100000,
  chains = 4,
  seed = 987654,
  #silent = TRUE,
  #refresh = 0,
  warmup = 5000,
  file = "./model-fits/nhb1/exploratory5b_bayesmodel_extremity"
)
```

#### Model summaries

```{r}
summary(exploratory_freqmodel)
summary(exploratory_bayesmodel)
```

#### Hypothesis test

Frequentist testing quantities

```{r}
# Coefficient estimate
coef2_freq <- exploratory_freqmodel$coefficients["composite_ideological_extremity_z:composite_political_orientation_z"]

# Confidence interval
confint2_freq <- confint(exploratory_freqmodel, "composite_ideological_extremity_z:composite_political_orientation_z")

# p-Value (extracted from model summary for two-sided test)
p_confirm2 <- summary(exploratory_freqmodel)$coefficients["composite_ideological_extremity_z:composite_political_orientation_z","Pr(>|t|)"]

data.frame("beta_z" = round(coef2_freq, 2),
           "CI_lower" = round(confint2_freq[1], 2),
           "CI_upper" = round(confint2_freq[2], 2),
           "p value" = round(p_confirm2, 3))
```

Bayesian testing quantities

```{r}
# Coefficient estimate
coef1_bayes <- fixef(exploratory_bayesmodel)["composite_ideological_extremity_z:composite_political_orientation_z", "Estimate"]

# Credible interval
cred1_bayes <- fixef(exploratory_bayesmodel)["composite_ideological_extremity_z:composite_political_orientation_z", c("Q2.5", "Q97.5")]

# Bayes factor
bf10 <- hypothesis(exploratory_bayesmodel, "composite_ideological_extremity_z:composite_political_orientation_z = 0")

data.frame("beta_z" = round(coef1_bayes, 2),
           "CI_lower" = round(cred1_bayes[1], 2),
           "CI_upper" = round(cred1_bayes[2], 2),
           "BF10" = 1/bf10$hypothesis$Evid.Ratio)
```

#### Conclusion
Generally, evidence for or against the interaction effect is weak. In the combined sample and the Prolific sample, there is anecdotal evidence in favor of the alternative hypothesis, in the MTurk sample, there is anecdotal evidence in favor of the null hypothesis. Frequentist results are significant only in the combined sample. 

## Interaction effect for Tajfel matrices

### Combined sample

#### Model fitting

```{r}
# Define model equation
exploratory_formula <- z_total_ingroup_minus_outgroup_points ~ composite_ideological_extremity_z * composite_political_orientation_z

# Fit frequentist model
exploratory_freqmodel <- lm(exploratory_formula, nhb1)

# Fit Bayesian model
exploratory_bayesmodel <- brms::brm(
  formula = exploratory_formula,
  data = nhb1,
  family = "gaussian",
  prior = exploratory_priors,
  sample_prior = TRUE, 
  iter = 100000,
  chains = 4,
  seed = 987654,
  #silent = TRUE,
  #refresh = 0,
  warmup = 5000,
  file = "./model-fits/nhb1/exploratory5_bayesmodel_extremity-points"
)
```

#### Model summaries

```{r}
summary(exploratory_freqmodel)
summary(exploratory_bayesmodel)
```

#### Hypothesis test

Frequentist testing quantities

```{r}
# Coefficient estimate
coef2_freq <- exploratory_freqmodel$coefficients["composite_ideological_extremity_z:composite_political_orientation_z"]

# Confidence interval
confint2_freq <- confint(exploratory_freqmodel, "composite_ideological_extremity_z:composite_political_orientation_z")

# p-Value (extracted from model summary for two-sided test)
p_confirm2 <- summary(exploratory_freqmodel)$coefficients["composite_ideological_extremity_z:composite_political_orientation_z","Pr(>|t|)"]

data.frame("beta_z" = round(coef2_freq, 2),
           "CI_lower" = round(confint2_freq[1], 2),
           "CI_upper" = round(confint2_freq[2], 2),
           "p value" = round(p_confirm2, 3))
```

Bayesian testing quantities

```{r}
# Coefficient estimate
coef1_bayes <- fixef(exploratory_bayesmodel)["composite_ideological_extremity_z:composite_political_orientation_z", "Estimate"]

# Credible interval
cred1_bayes <- fixef(exploratory_bayesmodel)["composite_ideological_extremity_z:composite_political_orientation_z", c("Q2.5", "Q97.5")]

# Bayes factor
bf10 <- hypothesis(exploratory_bayesmodel, "composite_ideological_extremity_z:composite_political_orientation_z = 0")

data.frame("beta_z" = round(coef1_bayes, 2),
           "CI_lower" = round(cred1_bayes[1], 2),
           "CI_upper" = round(cred1_bayes[2], 2),
           "BF10" = 1/bf10$hypothesis$Evid.Ratio)
```

### Prolific sample

#### Model fitting

```{r}
# Fit frequentist model
exploratory_freqmodel <- lm(exploratory_formula, nhb1a)

# Fit Bayesian model
exploratory_bayesmodel <- brms::brm(
  formula = exploratory_formula,
  data = nhb1a,
  family = "gaussian",
  prior = exploratory_priors,
  sample_prior = TRUE, 
  iter = 100000,
  chains = 4,
  seed = 987654,
  #silent = TRUE,
  #refresh = 0,
  warmup = 5000,
  file = "./model-fits/nhb1/exploratory5a_bayesmodel_extremity-points"
)
```

#### Model summaries

```{r}
summary(exploratory_freqmodel)
summary(exploratory_bayesmodel)
```

#### Hypothesis test

Frequentist testing quantities

```{r}
# Coefficient estimate
coef2_freq <- exploratory_freqmodel$coefficients["composite_ideological_extremity_z:composite_political_orientation_z"]

# Confidence interval
confint2_freq <- confint(exploratory_freqmodel, "composite_ideological_extremity_z:composite_political_orientation_z")

# p-Value (extracted from model summary for two-sided test)
p_confirm2 <- summary(exploratory_freqmodel)$coefficients["composite_ideological_extremity_z:composite_political_orientation_z","Pr(>|t|)"]

data.frame("beta_z" = round(coef2_freq, 2),
           "CI_lower" = round(confint2_freq[1], 2),
           "CI_upper" = round(confint2_freq[2], 2),
           "p value" = round(p_confirm2, 3))
```

Bayesian testing quantities

```{r}
# Coefficient estimate
coef1_bayes <- fixef(exploratory_bayesmodel)["composite_ideological_extremity_z:composite_political_orientation_z", "Estimate"]

# Credible interval
cred1_bayes <- fixef(exploratory_bayesmodel)["composite_ideological_extremity_z:composite_political_orientation_z", c("Q2.5", "Q97.5")]

# Bayes factor
bf10 <- hypothesis(exploratory_bayesmodel, "composite_ideological_extremity_z:composite_political_orientation_z = 0")

data.frame("beta_z" = round(coef1_bayes, 2),
           "CI_lower" = round(cred1_bayes[1], 2),
           "CI_upper" = round(cred1_bayes[2], 2),
           "BF10" = 1/bf10$hypothesis$Evid.Ratio)
```

### MTurk sample

#### Model fitting

```{r}
# Fit frequentist model
exploratory_freqmodel <- lm(exploratory_formula, nhb1b)

# Fit Bayesian model
exploratory_bayesmodel <- brms::brm(
  formula = exploratory_formula,
  data = nhb1b,
  family = "gaussian",
  prior = exploratory_priors,
  sample_prior = TRUE, 
  iter = 100000,
  chains = 4,
  seed = 987654,
  #silent = TRUE,
  #refresh = 0,
  warmup = 5000,
  file = "./model-fits/nhb1/exploratory5b_bayesmodel_extremity-points"
)
```

#### Model summaries

```{r}
summary(exploratory_freqmodel)
summary(exploratory_bayesmodel)
```

#### Hypothesis test

Frequentist testing quantities

```{r}
# Coefficient estimate
coef2_freq <- exploratory_freqmodel$coefficients["composite_ideological_extremity_z:composite_political_orientation_z"]

# Confidence interval
confint2_freq <- confint(exploratory_freqmodel, "composite_ideological_extremity_z:composite_political_orientation_z")

# p-Value (extracted from model summary for two-sided test)
p_confirm2 <- summary(exploratory_freqmodel)$coefficients["composite_ideological_extremity_z:composite_political_orientation_z","Pr(>|t|)"]

data.frame("beta_z" = round(coef2_freq, 2),
           "CI_lower" = round(confint2_freq[1], 2),
           "CI_upper" = round(confint2_freq[2], 2),
           "p value" = round(p_confirm2, 3))
```

Bayesian testing quantities

```{r}
# Coefficient estimate
coef1_bayes <- fixef(exploratory_bayesmodel)["composite_ideological_extremity_z:composite_political_orientation_z", "Estimate"]

# Credible interval
cred1_bayes <- fixef(exploratory_bayesmodel)["composite_ideological_extremity_z:composite_political_orientation_z", c("Q2.5", "Q97.5")]

# Bayes factor
bf10 <- hypothesis(exploratory_bayesmodel, "composite_ideological_extremity_z:composite_political_orientation_z = 0")

data.frame("beta_z" = round(coef1_bayes, 2),
           "CI_lower" = round(cred1_bayes[1], 2),
           "CI_upper" = round(cred1_bayes[2], 2),
           "BF10" = 1/bf10$hypothesis$Evid.Ratio)
```

### Conclusion

In all samples, evidence for the interaction is weak. In the combined sample and in the MTurk sample, there is (just so) moderate evidence for H1, in the Prolific sample, there is weak evidence for the null hypothesis. The frequentist test is non-significant in the Prolific and MTurk sample and significant in the combined sample.

## Interaction effect for evaluative trait scores

### Combined sample

#### Model fitting

```{r}
# Define model equation
exploratory_formula <- z_ingroup_minus_outgroup_traits_positive ~ composite_ideological_extremity_z * composite_political_orientation_z

# Fit frequentist model
exploratory_freqmodel <- lm(exploratory_formula, nhb1)

# Fit Bayesian model
exploratory_bayesmodel <- brms::brm(
  formula = exploratory_formula,
  data = nhb1,
  family = "gaussian",
  prior = exploratory_priors,
  sample_prior = TRUE, 
  iter = 100000,
  chains = 4,
  seed = 987654,
  #silent = TRUE,
  #refresh = 0,
  warmup = 5000,
  file = "./model-fits/nhb1/exploratory5_bayesmodel_extremity-traits"
)
```

#### Model summaries

```{r}
summary(exploratory_freqmodel)
summary(exploratory_bayesmodel)
```

#### Hypothesis test

Frequentist testing quantities

```{r}
# Coefficient estimate
coef2_freq <- exploratory_freqmodel$coefficients["composite_ideological_extremity_z:composite_political_orientation_z"]

# Confidence interval
confint2_freq <- confint(exploratory_freqmodel, "composite_ideological_extremity_z:composite_political_orientation_z")

# p-Value (extracted from model summary for two-sided test)
p_confirm2 <- summary(exploratory_freqmodel)$coefficients["composite_ideological_extremity_z:composite_political_orientation_z","Pr(>|t|)"]

data.frame("beta_z" = round(coef2_freq, 2),
           "CI_lower" = round(confint2_freq[1], 2),
           "CI_upper" = round(confint2_freq[2], 2),
           "p value" = round(p_confirm2, 3))
```

Bayesian testing quantities

```{r}
# Coefficient estimate
coef1_bayes <- fixef(exploratory_bayesmodel)["composite_ideological_extremity_z:composite_political_orientation_z", "Estimate"]

# Credible interval
cred1_bayes <- fixef(exploratory_bayesmodel)["composite_ideological_extremity_z:composite_political_orientation_z", c("Q2.5", "Q97.5")]

# Bayes factor
bf10 <- hypothesis(exploratory_bayesmodel, "composite_ideological_extremity_z:composite_political_orientation_z = 0")

data.frame("beta_z" = round(coef1_bayes, 2),
           "CI_lower" = round(cred1_bayes[1], 2),
           "CI_upper" = round(cred1_bayes[2], 2),
           "BF10" = 1/bf10$hypothesis$Evid.Ratio)
```

### Prolific sample

#### Model fitting

```{r}
# Fit frequentist model
exploratory_freqmodel <- lm(exploratory_formula, nhb1a)

# Fit Bayesian model
exploratory_bayesmodel <- brms::brm(
  formula = exploratory_formula,
  data = nhb1a,
  family = "gaussian",
  prior = exploratory_priors,
  sample_prior = TRUE, 
  iter = 100000,
  chains = 4,
  seed = 987654,
  #silent = TRUE,
  #refresh = 0,
  warmup = 5000,
  file = "./model-fits/nhb1/exploratory5a_bayesmodel_extremity-traits"
)
```

#### Model summaries

```{r}
summary(exploratory_freqmodel)
summary(exploratory_bayesmodel)
```

#### Hypothesis test

Frequentist testing quantities

```{r}
# Coefficient estimate
coef2_freq <- exploratory_freqmodel$coefficients["composite_ideological_extremity_z:composite_political_orientation_z"]

# Confidence interval
confint2_freq <- confint(exploratory_freqmodel, "composite_ideological_extremity_z:composite_political_orientation_z")

# p-Value (extracted from model summary for two-sided test)
p_confirm2 <- summary(exploratory_freqmodel)$coefficients["composite_ideological_extremity_z:composite_political_orientation_z","Pr(>|t|)"]

data.frame("beta_z" = round(coef2_freq, 2),
           "CI_lower" = round(confint2_freq[1], 2),
           "CI_upper" = round(confint2_freq[2], 2),
           "p value" = round(p_confirm2, 3))
```

Bayesian testing quantities

```{r}
# Coefficient estimate
coef1_bayes <- fixef(exploratory_bayesmodel)["composite_ideological_extremity_z:composite_political_orientation_z", "Estimate"]

# Credible interval
cred1_bayes <- fixef(exploratory_bayesmodel)["composite_ideological_extremity_z:composite_political_orientation_z", c("Q2.5", "Q97.5")]

# Bayes factor
bf10 <- hypothesis(exploratory_bayesmodel, "composite_ideological_extremity_z:composite_political_orientation_z = 0")

data.frame("beta_z" = round(coef1_bayes, 2),
           "CI_lower" = round(cred1_bayes[1], 2),
           "CI_upper" = round(cred1_bayes[2], 2),
           "BF10" = 1/bf10$hypothesis$Evid.Ratio)
```

### MTurk sample

#### Model fitting

```{r}
# Fit frequentist model
exploratory_freqmodel <- lm(exploratory_formula, nhb1b)

# Fit Bayesian model
exploratory_bayesmodel <- brms::brm(
  formula = exploratory_formula,
  data = nhb1b,
  family = "gaussian",
  prior = exploratory_priors,
  sample_prior = TRUE, 
  iter = 100000,
  chains = 4,
  seed = 987654,
  #silent = TRUE,
  #refresh = 0,
  warmup = 5000,
  file = "./model-fits/nhb1/exploratory5b_bayesmodel_extremity-traits"
)
```

#### Model summaries

```{r}
summary(exploratory_freqmodel)
summary(exploratory_bayesmodel)
```

#### Hypothesis test

Frequentist testing quantities

```{r}
# Coefficient estimate
coef2_freq <- exploratory_freqmodel$coefficients["composite_ideological_extremity_z:composite_political_orientation_z"]

# Confidence interval
confint2_freq <- confint(exploratory_freqmodel, "composite_ideological_extremity_z:composite_political_orientation_z")

# p-Value (extracted from model summary for two-sided test)
p_confirm2 <- summary(exploratory_freqmodel)$coefficients["composite_ideological_extremity_z:composite_political_orientation_z","Pr(>|t|)"]

data.frame("beta_z" = round(coef2_freq, 2),
           "CI_lower" = round(confint2_freq[1], 2),
           "CI_upper" = round(confint2_freq[2], 2),
           "p value" = round(p_confirm2, 3))
```

Bayesian testing quantities

```{r}
# Coefficient estimate
coef1_bayes <- fixef(exploratory_bayesmodel)["composite_ideological_extremity_z:composite_political_orientation_z", "Estimate"]

# Credible interval
cred1_bayes <- fixef(exploratory_bayesmodel)["composite_ideological_extremity_z:composite_political_orientation_z", c("Q2.5", "Q97.5")]

# Bayes factor
bf10 <- hypothesis(exploratory_bayesmodel, "composite_ideological_extremity_z:composite_political_orientation_z = 0")

data.frame("beta_z" = round(coef1_bayes, 2),
           "CI_lower" = round(cred1_bayes[1], 2),
           "CI_upper" = round(cred1_bayes[2], 2),
           "BF10" = 1/bf10$hypothesis$Evid.Ratio)
```

### Conclusion

In all three samples, the interaction effect is not significant, with at least moderate evidence in favor of the null hypothesis in the combined and MTurk sample, and indecisive evidence (BF ~ 1) in the Prolific sample.

## Interaction effect for group identification ratings

### Combined sample

#### Model fitting

```{r}
# Define model equation
exploratory_formula <- z_ingroup_minus_outgroup_identify ~ composite_ideological_extremity_z * composite_political_orientation_z

# Fit frequentist model
exploratory_freqmodel <- lm(exploratory_formula, nhb1)

# Fit Bayesian model
exploratory_bayesmodel <- brms::brm(
  formula = exploratory_formula,
  data = nhb1,
  family = "gaussian",
  prior = exploratory_priors,
  sample_prior = TRUE, 
  iter = 100000,
  chains = 4,
  seed = 987654,
  #silent = TRUE,
  #refresh = 0,
  warmup = 5000,
  file = "./model-fits/nhb1/exploratory5_bayesmodel_extremity-identify"
)
```

#### Model summaries

```{r}
summary(exploratory_freqmodel)
summary(exploratory_bayesmodel)
```

#### Hypothesis test

Frequentist testing quantities

```{r}
# Coefficient estimate
coef2_freq <- exploratory_freqmodel$coefficients["composite_ideological_extremity_z:composite_political_orientation_z"]

# Confidence interval
confint2_freq <- confint(exploratory_freqmodel, "composite_ideological_extremity_z:composite_political_orientation_z")

# p-Value (extracted from model summary for two-sided test)
p_confirm2 <- summary(exploratory_freqmodel)$coefficients["composite_ideological_extremity_z:composite_political_orientation_z","Pr(>|t|)"]

data.frame("beta_z" = round(coef2_freq, 2),
           "CI_lower" = round(confint2_freq[1], 2),
           "CI_upper" = round(confint2_freq[2], 2),
           "p value" = round(p_confirm2, 3))
```

Bayesian testing quantities

```{r}
# Coefficient estimate
coef1_bayes <- fixef(exploratory_bayesmodel)["composite_ideological_extremity_z:composite_political_orientation_z", "Estimate"]

# Credible interval
cred1_bayes <- fixef(exploratory_bayesmodel)["composite_ideological_extremity_z:composite_political_orientation_z", c("Q2.5", "Q97.5")]

# Bayes factor
bf10 <- hypothesis(exploratory_bayesmodel, "composite_ideological_extremity_z:composite_political_orientation_z = 0")

data.frame("beta_z" = round(coef1_bayes, 2),
           "CI_lower" = round(cred1_bayes[1], 2),
           "CI_upper" = round(cred1_bayes[2], 2),
           "BF10" = 1/bf10$hypothesis$Evid.Ratio)
```

### Prolific sample

#### Model fitting

```{r}
# Fit frequentist model
exploratory_freqmodel <- lm(exploratory_formula, nhb1a)

# Fit Bayesian model
exploratory_bayesmodel <- brms::brm(
  formula = exploratory_formula,
  data = nhb1a,
  family = "gaussian",
  prior = exploratory_priors,
  sample_prior = TRUE, 
  iter = 100000,
  chains = 4,
  seed = 987654,
  #silent = TRUE,
  #refresh = 0,
  warmup = 5000,
  file = "./model-fits/nhb1/exploratory5a_bayesmodel_extremity-identify"
)
```

#### Model summaries

```{r}
summary(exploratory_freqmodel)
summary(exploratory_bayesmodel)
```

#### Hypothesis test

Frequentist testing quantities

```{r}
# Coefficient estimate
coef2_freq <- exploratory_freqmodel$coefficients["composite_ideological_extremity_z:composite_political_orientation_z"]

# Confidence interval
confint2_freq <- confint(exploratory_freqmodel, "composite_ideological_extremity_z:composite_political_orientation_z")

# p-Value (extracted from model summary for two-sided test)
p_confirm2 <- summary(exploratory_freqmodel)$coefficients["composite_ideological_extremity_z:composite_political_orientation_z","Pr(>|t|)"]

data.frame("beta_z" = round(coef2_freq, 2),
           "CI_lower" = round(confint2_freq[1], 2),
           "CI_upper" = round(confint2_freq[2], 2),
           "p value" = round(p_confirm2, 3))
```

Bayesian testing quantities

```{r}
# Coefficient estimate
coef1_bayes <- fixef(exploratory_bayesmodel)["composite_ideological_extremity_z:composite_political_orientation_z", "Estimate"]

# Credible interval
cred1_bayes <- fixef(exploratory_bayesmodel)["composite_ideological_extremity_z:composite_political_orientation_z", c("Q2.5", "Q97.5")]

# Bayes factor
bf10 <- hypothesis(exploratory_bayesmodel, "composite_ideological_extremity_z:composite_political_orientation_z = 0")

data.frame("beta_z" = round(coef1_bayes, 2),
           "CI_lower" = round(cred1_bayes[1], 2),
           "CI_upper" = round(cred1_bayes[2], 2),
           "BF10" = 1/bf10$hypothesis$Evid.Ratio)
```

### MTurk sample

#### Model fitting

```{r}
# Fit frequentist model
exploratory_freqmodel <- lm(exploratory_formula, nhb1b)

# Fit Bayesian model
exploratory_bayesmodel <- brms::brm(
  formula = exploratory_formula,
  data = nhb1b,
  family = "gaussian",
  prior = exploratory_priors,
  sample_prior = TRUE, 
  iter = 100000,
  chains = 4,
  seed = 987654,
  #silent = TRUE,
  #refresh = 0,
  warmup = 5000,
  file = "./model-fits/nhb1/exploratory5b_bayesmodel_extremity-identify"
)
```

#### Model summaries

```{r}
summary(exploratory_freqmodel)
summary(exploratory_bayesmodel)
```

#### Hypothesis test

Frequentist testing quantities

```{r}
# Coefficient estimate
coef2_freq <- exploratory_freqmodel$coefficients["composite_ideological_extremity_z:composite_political_orientation_z"]

# Confidence interval
confint2_freq <- confint(exploratory_freqmodel, "composite_ideological_extremity_z:composite_political_orientation_z")

# p-Value (extracted from model summary for two-sided test)
p_confirm2 <- summary(exploratory_freqmodel)$coefficients["composite_ideological_extremity_z:composite_political_orientation_z","Pr(>|t|)"]

data.frame("beta_z" = round(coef2_freq, 2),
           "CI_lower" = round(confint2_freq[1], 2),
           "CI_upper" = round(confint2_freq[2], 2),
           "p value" = round(p_confirm2, 3))
```

Bayesian testing quantities

```{r}
# Coefficient estimate
coef1_bayes <- fixef(exploratory_bayesmodel)["composite_ideological_extremity_z:composite_political_orientation_z", "Estimate"]

# Credible interval
cred1_bayes <- fixef(exploratory_bayesmodel)["composite_ideological_extremity_z:composite_political_orientation_z", c("Q2.5", "Q97.5")]

# Bayes factor
bf10 <- hypothesis(exploratory_bayesmodel, "composite_ideological_extremity_z:composite_political_orientation_z = 0")

data.frame("beta_z" = round(coef1_bayes, 2),
           "CI_lower" = round(cred1_bayes[1], 2),
           "CI_upper" = round(cred1_bayes[2], 2),
           "BF10" = 1/bf10$hypothesis$Evid.Ratio)
```

### Conclusion
In all samples, the frequentist test is non-significant and there is weak evidence for the null hypothesis of no interaction.

## System information (for reproducibility)

```{r}
Sys.info()[1:3]
sessionInfo()
```