---
title: "nhb1_exploratory"
author: "Youssef Amin"
date: "2024-06-05"
output: html_document
---
## Load packages
```{r setup, message=FALSE, warning=FALSE, error = FALSE}
library(bayestestR)
library(BayesFactor)
library(ggtext)
library(interactions)
library(brms)
library(tidyverse)
library(magrittr)
library(bayestestR)
library(BayesFactor)
library(lme4)
library(nlme)
library(logspline)
library(mediation)
library(corrplot)
library(emmeans)
library(Hmisc)
library(reghelper)
library(jtools)
testSlopesBinaryInteraction <- function(modelfit){
  SE <- coef(summary(modelfit))[3,"Std.Error"]
  param_baseline <- coef(summary(modelfit))[3, "Value"]
  param_otherGroup <- coef(summary(modelfit))[4, "Value"] + param_baseline
  tvals <- c(param_baseline, param_otherGroup)/SE
  df <- coef(summary(modelfit))[3,"DF"]
  pvals <- 2*pt(-abs(tvals), df)
  names(pvals) <- c("baseline group", "non-baseline group")
  out <- rbind(pvals, estimates=c(param_baseline, param_otherGroup))
  return(out)
}
```
  
<br>
<br>

## Read in data
```{r}
# Set seed
set.seed (987654)
nhb1 <- read.csv("/Users/youssefamin/Dropbox/MinimalGroup_NHB_Master/MinimalGroup_NHB1/data/nhb1_bothsamples_processed.csv")
nhb1$WhichSample <- factor(nhb1$WhichSample)
```
  
<br>
<br>

# Exploratory Analyses
## Summary
1. <span style="color:green">Ingroup favoritism</span> drives the relationship between <span style="color:green"> ideology and bias </span>.
2. <span style="color:red">Ideological extremity</span> does **not** predict <span style="color:red">bias</span>
3. There **is** a moderate interaction between <span style="color:green">ideology</span> and <span style="color:green">ideological extremity </span> in their relationship with <span style="color:green">bias</span>. As liberals get less extreme, they are more biased. As conservatives get more conservative, there is not a change in bias.
4. There are **no** differences between <span style="color:red">measures of bias</span> in their relationships with <span style="color:red">ideology</span>
5. There **is** a difference between <span style="color:green">the measures of ideology</span> in their relationships with <span style="color:green">bias</span>. Issue-based ideology is slightly more associated with bias than self-identified ideology (e.g., "I am a conservative").
6. There are **no** differences between <span style="color:red">measures of extremity</span> and their relationship with <span style="color:red">bias</span>
7. There are mild relationships between <span style="color:green">ideology</span> and these distribution strategies: <span style="color:green">Ingroup favoritism on maximum joint profit, maximum joint profit on ingroup favoritism, and ingroup favoritism on parity</span>
8. <span style="color:green">Ideology</span> predicts <span style="color:green">intergroup bias</span> in both samples, but the effect is greater in the <span style="color:green">Prolific</span> sample. 
  
  
  
  
<br>
<br>

## Exploratory 1: Does <span style="color:green">ingroup favoritism</span> or <span style="color:red">outgroup derogation</span> drive the relationship between ideology and bias?
```{r exploratory 1 formula}
exploratory1_data <- nhb1 %>%
  pivot_longer(cols = c(IngroupIndex_z, OutgroupIndex_z), names_to = "measure_type", values_to = "group_rating")
exploratory1_data$measure_type <- factor(exploratory1_data$measure_type, levels = c("OutgroupIndex_z", "IngroupIndex_z"))

exploratory1a_formula <- group_rating ~ measure_type * composite_political_orientation_z
exploratory1b_formula <- group_rating ~ measure_type * composite_ideological_extremity_z

exploratory1_bayesFormula <- group_rating ~ measure_type * composite_political_orientation_z + (1|PROLIFIC_PID)
```
<br>

### Compute Frequentist
```{r exploratory 1 compute frequentist}
exploratory1a_freqmodel <- lme(exploratory1a_formula,
                               random =~1|PROLIFIC_PID, 
                               method = "REML",
                               data = exploratory1_data,
                               na.action = na.omit) #**
exploratory1b_freqmodel <- lme(exploratory1b_formula,
                               random =~1|PROLIFIC_PID, 
                               method = "REML",
                               data = exploratory1_data,
                               na.action = na.omit)
exploratory1_simpleslopes <- emtrends(exploratory1a_freqmodel,  "measure_type", var = "composite_political_orientation_z")
```
<br>

### Compute Bayesian
```{r exploratory 1 compute bayesian, results = 'hide', warning=FALSE, message=FALSE }
exploratory1_priors <- set_prior("normal(0, 0.5)", class="b")
exploratory1_bayesmodel <- brm(exploratory1_bayesFormula, 
                data=exploratory1_data, 
                prior = exploratory1_priors, 
                sample_prior = TRUE,
                refresh = 0,
                silent = TRUE,
                seed = 9878654)

exploratory1_bf <- bayesfactor_parameters(
                       exploratory1_bayesmodel, 
                       direction = "two-sided", 
                       parameters = "measure_type")
exploratory1_emmeans_bayes <- emmeans(exploratory1_bayesmodel, ~ composite_political_orientation_z, 
        at = list(composite_political_orientation_z = c(-2,0,2)), by = "measure_type")


```
<br>

```{r exploratory 1 plot, results='hide', echo=FALSE, warning=FALSE, message=FALSE}
conditional_effects(exploratory1_bayesmodel, "composite_political_orientation_z:measure_type", int_conditions = list(type=c(0,1)))
```
  
### Exploratory 1 Results: <span style="color:green">Ingroup favoritism</span> drives the relationship between ideology and bias.
Ingroup favoritism is correlated with ideology, but outgroup derogation is not.
```{r exploratory 1 results}
###FREQUENTIST
summary(exploratory1a_freqmodel)
exploratory1_simpleslopes
pairs(exploratory1_simpleslopes)
testSlopesBinaryInteraction(exploratory1a_freqmodel)
summary(exploratory1b_freqmodel)

###BAYESIAN
summary(exploratory1_bayesmodel)
exploratory1_bf
exploratory1_emmeans_bayes
hypothesis(exploratory1_bayesmodel,
           c(Ideology = "composite_political_orientation_z=0", # this is the slope of the type=0 line in the plot before
             IngroupFavoritism = "composite_political_orientation_z + measure_typeIngroupIndex_z:composite_political_orientation_z = 0") 
)


```
<br>
<br>

## Exploratory 2: Does <span style="color:green">ideological extremity</span> predict <span style="color:green">bias</span>?
```{r exploratory 2}
exploratory2_formula <- mean_intergroup_bias_z ~ composite_ideological_extremity_z
```
<br>

### Compute Frequentist
```{r exploratory 2 compute frequentist}
exploratory2_freqmodel <- lm(exploratory2_formula, data = nhb1)
```
<br>

### Compute Bayesian
```{r exploratory 2 compute bayesian, results = 'hide', warning=FALSE, message=FALSE }
# Define priors for the regression model
exploratory2_priors <- c(set_prior("normal(0, 0.5)", class = "b"))

# Run the regression model
exploratory2_bayesmodel<- brm(
  formula = exploratory2_formula, 
  data = nhb1, 
  family = gaussian(),
  prior = exploratory2_priors,
  sample_prior = "no",
  iter = 100000,  # Adjust iterations based on convergence diagnostics
  chains = 4,
  seed = 987654,
  warmup = 5000,
  refresh = 0,
  silent = TRUE
)


exploratory2_priordraws <- brms::brm(exploratory2_formula, 
                                data = nhb1, 
                                family = "gaussian",
                                prior = exploratory2_priors,
                                sample_prior = "only",
                                refresh = 0,
                                silent = TRUE,
                                seed = 987654,
                                iter = 100000)

exploratory2_bf <- bayesfactor_parameters(
                       exploratory2_bayesmodel,
                       prior=exploratory2_priordraws, 
                       direction = "two-sided", 
                       parameters = "composite_ideological_extremity_z")
```
<br>

```{r results='hide', echo=FALSE, warning=FALSE, message=FALSE}
exploratory2_bayesmodel
exploratory2_bayesmodel[["fit"]]
exploratory2_bayesmodel[["fit"]]@.MISC
exploratory2_bayesmodel[["fit"]]@.MISC[["summary"]]
```


```{r exploratory 2 plot,results='hide', echo=FALSE, warning=FALSE, message=FALSE}
exploratory2_bf_long <- round(exp(exploratory2_bf$log_BF), 2)
exploratory2_beta <- round(exploratory2_bayesmodel[["fit"]]@.MISC[["summary"]]$msd["b_composite_ideological_extremity_z", "mean"],2)
exploratory2_plot <- ggplot(nhb1, aes(x = composite_ideological_extremity_z, y = mean_intergroup_bias_z, 
                                       color = composite_ideological_extremity_z)) +
  geom_point(size = 3, alpha = 0.7) +
  geom_smooth(method = "lm", color = "black", linetype = "solid") +
  scale_color_gradient2(low = "grey", mid = "pink", high = "red1", midpoint = 0) +
  labs(
    x = "Ideological Extremity (z-scored)",
    y = "Minimal Intergroup Bias (z-scored)",
    title = "Relationship between Ideological Extremity and Minimal Intergroup Bias",
    color = "Extremity"
  ) +
  theme_minimal() +
  annotate("text", x = Inf, y = Inf, 
           label = 
             bquote(beta[z] == .(paste(exploratory2_beta, ",", sep =""))~
                      'BF'[10] == .(formatC(log10(exploratory2_bf_long), format = "fg", digits = 3)) %*% 10^.(floor(log10(exploratory2_bf_long)))),
           parse = FALSE,
           hjust = 1.1, vjust = 1.1, size = 5, color = "black")
  theme(plot.title = element_text(hjust = 0.5))
  exploratory2_plot
```

### Exploratory 2 Results: <span style="color:green">Ideological extremity</span> **predicts** <span style="color:green">bias</span>
```{r exploratory 2 results}
###FREQUENTIST
summary(exploratory2_freqmodel)
summary(exploratory2_bayesmodel)

###BAYESIAN
1/exp(exploratory2_bf$log_BF)
```
<br>
<br>

## Exploratory 3: Is there an interaction between <span style="color:green">ideological extremity</span> and <span style="color:green">ideology</span> on <span style="color:green">bias</span>?
```{r exploratory 3 formula}
exploratory3_formula <- mean_intergroup_bias_z ~ composite_political_orientation_z * composite_ideological_extremity_z
```
<br>

### Compute Frequentist
```{r exploratory 3 compute frequentist}
exploratory3_freqmodel          <- lm(exploratory3_formula, data = nhb1)
exploratory3_freqmodel_cons  <- lm(exploratory2_formula, data = subset(nhb1, nhb1$composite_political_orientation_z > 1))
exploratory3_freqmodel_libs <- lm(exploratory2_formula, data = subset(nhb1, nhb1$composite_political_orientation_z < -1))
```
<br>

### Compute Bayesian
```{r exploratory 3 compute bayesian, results = 'hide', warning=FALSE, message=FALSE}
exploratory3_priors<- set_prior("normal(0, 0.5)", class = "b")

# Fit the model using brms
exploratory3_bayesmodel <- brm(
  formula = exploratory3_formula,
  data = nhb1,
  family = gaussian(),
  prior = exploratory3_priors,
  sample_prior = "no",
  iter = 100000,
  chains = 4,
  seed = 987654,
  warmup = 5000,
  refresh = 0,
  silent = TRUE
)

exploratory3_priordraws <- brms::brm(exploratory3_formula, 
                                        data = nhb1, 
                                        family = "gaussian",
                                        prior = exploratory3_priors,
                                        sample_prior = "only",
                                        seed = 987654,
                                        iter = 100000,
                                        refresh = 0,
                                        silent = TRUE)


exploratory3_bf <- bayesfactor_parameters(exploratory3_bayesmodel,
                       prior=exploratory3_priordraws, 
                       direction = "two-sided", 
                       parameters = "composite_political_orientation_z:composite_ideological_extremity_z")
```
<br>
```{r results='hide', echo=FALSE, warning=FALSE, message=FALSE}
exploratory3_bayesmodel
exploratory3_bayesmodel[["fit"]]
exploratory3_bayesmodel[["fit"]]@.MISC
exploratory3_bayesmodel[["fit"]]@.MISC[["summary"]]
```


```{r exploratory 3 plot, results='hide', echo=FALSE, warning=FALSE, message=FALSE}
# Create the plot
exploratory3_bf_long <- round(exp(exploratory3_bf$log_BF), 2)
exploratory3_beta <- round(exploratory3_bayesmodel[["fit"]]@.MISC[["summary"]]$msd["b_composite_political_orientation_z", "mean"],2)
exploratory3_plot <- ggplot(nhb1, aes(x = composite_political_orientation_z, y = mean_intergroup_bias_z, color = composite_ideological_extremity_z)) +
  geom_point(size = 3, alpha = 0.7) +
  geom_smooth(method = "lm", aes(color = composite_ideological_extremity_z), formula = y ~ x * composite_ideological_extremity_z, linetype = "solid")  +
  scale_color_gradient2(low = "grey97", mid = "pink", high = "red1", midpoint = 0) +
  labs(
    x = "Ideology (z-scored)",
    y = "Minimal Intergroup Bias (z-scored)",
    title = "Interaction between Ideology and Ideological Extremity on Minimal Intergroup Bias",
    color = "Ideological Extremity"
  ) +
  theme_minimal() +
  annotate("text", x = Inf, y = Inf, 
           label = bquote(beta[z] == .(paste(exploratory3_beta, ",", sep =''))~
                            'BF'[10] == .(formatC(log10(exploratory3_bf_long), format = "fg", digits = 3)) %*% 10^.(floor(log10(exploratory3_bf_long)))),
           parse = FALSE,
           hjust = 1.1, vjust = 1.1, size = 5, color = "black") +
  theme(plot.title = element_text(hjust = 0.5))


exploratory3_plot2 <- interact_plot(exploratory3_freqmodel, 
              modx = composite_political_orientation_z, 
              pred = composite_ideological_extremity_z,
              legend.main = "Ideology",
              modx.labels = c("Liberal leaning (SD -1)", "Middle", "Conservative leaning (SD +1"))+
  labs(x = "Extremity",
       y = "Intergroup Bias",
       title = "Interaction between extremity and ideology") +
  annotate("text", x = Inf, y = Inf, 
           label = bquote(beta[z] == .(paste(exploratory3_beta, ",", sep =''))~
                            'BF'[10] == .(formatC(log10(exploratory3_bf_long), format = "fg", digits = 3)) %*% 10^.(floor(log10(exploratory3_bf_long)))),
           parse = FALSE,
           hjust = 1.1, vjust = 1.1, size = 5, color = "black")
exploratory3_plot
exploratory3_plot2
```

### Exploratory 3 Results: There **is** a moderate interaction between <span style="color:green">ideology</span> and <span style="color:green"> ideological extremity</span> their relationship with <span style="color:green">bias</span>
More conservatism is associated with bias, but differently between liberals and conservatives: Conservatives' bias gets higher with ideological extremity. There's no relationship between ideology and extremity in more liberal participants.
```{r exploratory 3 results, warning=FALSE}
###FREQUENTIST
summary(exploratory3_freqmodel)
summary(exploratory3_freqmodel_cons) #Among more conservative participants, there's a relationship between extremity and bias.
summary(exploratory3_freqmodel_libs) #Among more liberal participants, there's no relatinship between extremity and bias.

###BAYESIAN
summary(exploratory3_bayesmodel)
exp(exploratory3_bf$log_BF)
```
<br>
<br>

## Exploratory 4: Are differences between <span style="color:red">measures of intergroup bias</span> and their relationship with <span style="color:red">ideology</span>?
```{r exploratory 4 formula}
exploratory4_data <- nhb1 %>%
  pivot_longer(cols = c(z_total_ingroup_minus_outgroup_points,z_ingroup_minus_outgroup_traits_positive,z_ingroup_minus_outgroup_identify), names_to = "measure_type", values_to = "group_rating") %>% 
  mutate(measure_type = dplyr::recode(measure_type, 
                               z_total_ingroup_minus_outgroup_points    = "points",
                               z_ingroup_minus_outgroup_traits_positive = "traits",
                               z_ingroup_minus_outgroup_identify        = "identification"))
exploratory4_data$measure_type <- factor(exploratory4_data$measure_type, levels = c("traits", "points", "identification"))

exploratory4a_formula <- group_rating ~ measure_type * composite_political_orientation_z
exploratory4b_formula <- group_rating ~ measure_type * composite_ideological_extremity_z

exploratory4_bayesFormula <- group_rating ~ measure_type * composite_political_orientation_z + (1|PROLIFIC_PID)
```
<br>

### Compute Frequentist
```{r exploratory 4 compute frequentist}
exploratory4a_freqmodel <- lme(exploratory4a_formula,
                               random =~1|PROLIFIC_PID,
                               method = "REML",
                               data = exploratory4_data,
                               na.action = na.omit) #**
exploratory4b_freqmodel <- lme(exploratory4b_formula,
                               random =~1|PROLIFIC_PID, 
                               method = "REML",
                               data = exploratory4_data,
                               na.action = na.omit)
exploratory4_simpleslopes <- emtrends(exploratory4a_freqmodel,  "measure_type", var = "composite_political_orientation_z")
```
<br>

### Compute Bayesian
```{r exploratory 4 compute bayesian, results = 'hide', warning=FALSE, message=FALSE }
exploratory4_priors <- set_prior("normal(0, 0.5)", class="b")
exploratory4_bayesmodel <- brm(exploratory4_bayesFormula, 
                data=exploratory4_data, 
                prior = exploratory4_priors, 
                sample_prior = TRUE,
                refresh = 0,
                silent = TRUE,
                seed = 9878654)

exploratory4_bf <- bayesfactor_parameters(
                       exploratory4_bayesmodel, 
                       direction = "two-sided", 
                       parameters = "measure_type")
exploratory4_emmeans_bayes <- emmeans(exploratory4_bayesmodel, ~ composite_political_orientation_z, 
        at = list(composite_political_orientation_z = c(-2,0,2)), by = "measure_type")
```
<br> 

```{r exploratory 4 plot, results='hide', echo=FALSE, warning=FALSE, message=FALSE}
conditional_effects(exploratory4_bayesmodel, "composite_political_orientation_z:measure_type", int_conditions = list(type=c(0,1)))
```

### Exploratory 4 Results: There are **no** differences between <span style="color:red">measures of bias</span> and their relationships with <span style="color:red">ideology</span>
```{r exploratory 4 results}
###FREQUENTIST
summary(exploratory4a_freqmodel)
exploratory4_simpleslopes
pairs(exploratory4_simpleslopes)
testSlopesBinaryInteraction(exploratory4a_freqmodel)
summary(exploratory4b_freqmodel)

###BAYESIAN
summary(exploratory4_bayesmodel)
exploratory4_bf
exploratory4_emmeans_bayes
hypothesis(exploratory4_bayesmodel,
           c(Ideology = "composite_political_orientation_z=0", # this is the slope of the type=0 line in the plot before
             Identification = "composite_political_orientation_z + measure_typeidentification:composite_political_orientation_z = 0",
             Points = "composite_political_orientation_z + measure_typepoints:composite_political_orientation_z = 0") # this is the slope of the type=1 line in the plot before
)



```
<br>
<br>

## Exploratory 5: Are there differences between <span style="color:red">measures of ideology</span> and their relationship with <span style="color:red"> bias</span>?
```{r exploratory 5 formula}
exploratory5_data <- nhb1 %>%
  pivot_longer(cols = c(self_identification_political_z, z_mean_SECS), names_to = "measure_type", values_to = "ideology_rating") %>% 
  mutate(measure_type = dplyr::recode(measure_type, 
                               self_identification_political_z    = "self_report",
                               z_mean_SECS = "issue_based"))
exploratory5_data$measure_type <- factor(exploratory5_data$measure_type, levels = c("self_report", "issue_based"))


exploratory5_formula <- ideology_rating ~ mean_intergroup_bias_z * measure_type
exploratory5_bayesFormula <- ideology_rating ~ mean_intergroup_bias_z * measure_type + (1|PROLIFIC_PID)
```
 <br> 
 
### Compute Frequentist
```{r exploratory 5 compute frequentist}
exploratory5_freqmodel <- lme(exploratory5_formula,
                               random =~1|PROLIFIC_PID, 
                               method = "REML",
                               data = exploratory5_data,
                               na.action = na.omit) #**
exploratory5_simpleslopes <- emtrends(exploratory5_freqmodel,  "measure_type", var = "mean_intergroup_bias_z")
```
<br>

### Compute Bayesian
```{r exploratory 5 compute bayesian, results = 'hide', warning=FALSE, message=FALSE }
exploratory5_priors <- set_prior("normal(0, 0.5)", class="b")
exploratory5_bayesmodel <- brm(exploratory5_bayesFormula, 
                data=exploratory5_data, 
                prior = exploratory5_priors, 
                sample_prior = TRUE,
                refresh = 0,
                silent = TRUE,
                seed = 9878654)

exploratory5_bf <- bayesfactor_parameters(
                       exploratory5_bayesmodel, 
                       direction = "two-sided", 
                       parameters = "measure_type")

exploratory5_emmeans_bayes <- emmeans(exploratory5_bayesmodel, ~ mean_intergroup_bias_z, 
        at = list(mean_intergroup_bias_z = c(-2,0,2)), by = "measure_type")

```
<br> 

```{r exploratory 5 plot, results='hide', echo=FALSE, warning=FALSE, message=FALSE}
conditional_effects(exploratory5_bayesmodel, "mean_intergroup_bias_z:measure_type", int_conditions = list(type=c(0,1)))
```
  
### Exploratory 5 Results: There is **not** a difference between <span style="color:red">the measures of ideology</span> and their relationships with <span style="color:red">bias</span>. 
Issue-based ideology is more correlated with bias than self-identification-based ideology.
```{r exploratory 5 results}
###FREQUENTIST
summary(exploratory5_freqmodel)
exploratory5_simpleslopes
pairs(exploratory5_simpleslopes)
testSlopesBinaryInteraction(exploratory5_freqmodel)

###BAYESIAN
summary(exploratory5_bayesmodel)
exploratory5_bf
exploratory5_emmeans_bayes
hypothesis(exploratory5_bayesmodel,
           c(Bias = "mean_intergroup_bias_z=0", # this is the slope of the type=0 line in the plot before
             Issue_Based = "mean_intergroup_bias_z + mean_intergroup_bias_z:measure_typeissue_based = 0") # this is the slope of the type=1 line in the plot before
)

```
<br>
<br>

## Exploratory 6: Are there differences between <span style="color:red">measures of extremity</span> and their relationship with <span style="color:red">bias</span>?    
```{r exploratory 6 formula}
exploratory6_data <- nhb1 %>%
  pivot_longer(cols = c(selfIDExtremity_z, z_SECSExtremity), names_to = "measure_type", values_to = "extremity_rating") %>% 
  mutate(measure_type = dplyr::recode(measure_type, 
                               selfIDExtremity_z    = "self_report",
                               z_SECSExtremity = "issue_based"))


exploratory6_data$extremity_rating <- scale(exploratory6_data$extremity_rating)
exploratory6_data$measure_type <- factor(exploratory6_data$measure_type, levels = c("self_report", "issue_based"))

exploratory6_formula <- extremity_rating ~ mean_intergroup_bias_z * measure_type

exploratory6_bayesFormula <- extremity_rating ~ mean_intergroup_bias_z * measure_type + (1|PROLIFIC_PID)
```
<br>

### Compute Frequentist
```{r exploratory 6 compute frequentist}
exploratory6_freqmodel <- lme(exploratory6_formula,
                               random =~1|PROLIFIC_PID, 
                               method = "REML",
                               data = exploratory6_data,
                               na.action = na.omit) #**
exploratory6_simpleslopes <- emtrends(exploratory6_freqmodel,  "measure_type", var = "mean_intergroup_bias_z")
```
<br>

### Compute Bayesian
```{r exploratory 6 compute bayesian, results = 'hide', warning=FALSE, message=FALSE }
exploratory6_priors <- set_prior("normal(0, 0.5)", class="b")
exploratory6_bayesmodel <- brm(exploratory6_bayesFormula, 
                data=exploratory6_data, 
                prior = exploratory6_priors, 
                sample_prior = TRUE,
                refresh = 0,
                silent = TRUE,
                seed = 9878654)

exploratory6_bf <- bayesfactor_parameters(
                       exploratory6_bayesmodel, 
                       direction = "two-sided", 
                       parameters = "measure_type")
exploratory6_emmeans_bayes <- emmeans(exploratory6_bayesmodel, ~ mean_intergroup_bias_z, 
        at = list(mean_intergroup_bias_z = c(-2,0,2)), by = "measure_type")
```
<br>

```{r exploratory 6 plot, results='hide', echo=FALSE, warning=FALSE, message=FALSE}
conditional_effects(exploratory6_bayesmodel, "mean_intergroup_bias_z:measure_type", int_conditions = list(type=c(0,1)))
```
  
### Exploratory 6 Results: There are **no** differences between <span style="color:red">measures of extremity</span> and their relationship with <span style="color:red">bias</span>
```{r exploratory 6 results}
###FREQUENTIST
summary(exploratory6_freqmodel)
exploratory6_simpleslopes
pairs(exploratory6_simpleslopes)
testSlopesBinaryInteraction(exploratory6_freqmodel)

###BAYESIAN
summary(exploratory6_bayesmodel)
exploratory6_bf

exploratory6_emmeans_bayes
hypothesis(exploratory6_bayesmodel,
           c(Bias = "mean_intergroup_bias_z=0", # this is the slope of the type=0 line in the plot before
             Issue_Based = "mean_intergroup_bias_z + mean_intergroup_bias_z:measure_typeissue_based = 0") # this is the slope of the type=1 line in the plot before
)

```
  
  
  
  

<br>
<br>

## Exploratory 7: Are there relationships between different <span style="color:green">pull scores</span> and <span style="color:green">ideology</span>?
```{r exploratory 7 data}
exploratory7_data <- nhb1[, c("composite_political_orientation_z", 
  "Pull_FAVonMJP",
  "Pull_MJPonFAV",
  "Pull_MDonProfit",
  "Pull_ProfitonMD",
  "Pull_PonFAV",
  "Pull_FAVonP")]
names(exploratory7_data) <- c("Ideology",   
                         "FAVonMJP",
                         "MJPonFAV",
                         "MDonProfit",
                         "ProfitonMD",
                         "PonFAV",
                         "FAVonP")

```
<br>

### Compute Frequentist
```{r exploratory 7 compute frequentist}
exploratory7_cor <- rcorr(as.matrix(exploratory7_data))
```
<br>

### Compute Bayesian
```{r exploratory 7 compute bayesian, results = 'hide', warning=FALSE, message=FALSE }
exploratory7_bfs <- c()
exploratory7_cols <- c()
exploratory7_bayessummaries <- list()
for (taj in names(exploratory7_data)[-1]){
  thisBF <- correlationBF(exploratory7_data[, 'Ideology'], exploratory7_data[, taj])
  samples <- posterior(thisBF, iterations = 100000)
  exploratory7_bayessummaries[taj] <- summary(samples)
  thisBF            <- exp(thisBF@bayesFactor$bf)
  exploratory7_bfs  <- c(exploratory7_bfs, thisBF) 
  exploratory7_cols <- c(exploratory7_cols, taj)
}

exploratory7_bayescor <- data.frame(Pull = exploratory7_cols,
                                    BF = exploratory7_bfs)
```
<br>

```{r exploratory 7 plot, results='hide', echo=FALSE, warning=FALSE, message=FALSE}
corrplot(exploratory7_cor$r, type="upper", order="original", 
         tl.srt = 25, diag = FALSE, method = "color",
         p.mat = exploratory7_cor$P, sig.level = 0.05, insig = "label_sig")
```
  
### Exploratory 7 Results: There are mild relationships between <span style="color:green">ideology</span> and these distribution strategies: <span style="color:green">Ingroup favoritism on maximum joint profit, maximum differentiation on maximum joint profit, maximum joint profit on ingroup favoritism, and ingroup favoritism on parity <span>
```{r exploratory 7 results}
##FREQUENTIST
exploratory7_cor

##BAYESIAN
exploratory7_bayescor
exploratory7_bayessummaries
```
<br>
<br>

## Exploratory 8: Does <span style="color:green">ideology</span> predict <span style="color:green">intergroup bias</span> more in one sample?
<br>

### Compute Frequentist
```{r exploratory 8 compute frequentist}
confirmatory1_formula <- mean_intergroup_bias_z ~ composite_political_orientation_z
exploratory8a_freqmodel <- lm(confirmatory1_formula, data = subset(nhb1, nhb1$WhichSample == 'A'))
exploratory8b_freqmodel <- lm(confirmatory1_formula, data = subset(nhb1, nhb1$WhichSample == 'B'))
```
<br>

### Compute Bayesian
```{r exporatory 8 compute bayesian, message=FALSE, results='hide', warning=FALSE}
# Run the regression model
confirmatory1_priors <- c(set_prior("normal(0, 0.5)", class = "b"))
exploratory8a_bayesmodel <- brm(
  formula = confirmatory1_formula, 
  data = subset(nhb1, nhb1$WhichSample == 'A'), 
  family = gaussian(),
  prior = confirmatory1_priors,
  sample_prior = "no",
  iter = 100000,  # Adjust iterations based on convergence diagnostics
  chains = 4,
  seed = 987654,
  silent = TRUE,
  refresh = 0,
  warmup = 5000
)

exploratory8b_bayesmodel <- brm(
  formula = confirmatory1_formula, 
  data = subset(nhb1, nhb1$WhichSample == 'B'), 
  family = gaussian(),
  prior = confirmatory1_priors,
  sample_prior = "no",
  iter = 100000,  # Adjust iterations based on convergence diagnostics
  chains = 4,
  seed = 987654,
  silent = TRUE,
  refresh = 0,
  warmup = 5000
)

exploratory8a_priordraws<- brms::brm(confirmatory1_formula, 
                            data = subset(nhb1, nhb1$WhichSample == 'A'), 
                            family = "gaussian",
                            prior = confirmatory1_priors,
                            sample_prior = "only",
                            seed = 987654,
                            silent = TRUE,
                            refresh = 0,
                            iter = 100000)

exploratory8b_priordraws<- brms::brm(confirmatory1_formula, 
                            data = subset(nhb1, nhb1$WhichSample == 'B'), 
                            family = "gaussian",
                            prior = confirmatory1_priors,
                            sample_prior = "only",
                            seed = 987654,
                            silent = TRUE,
                            refresh = 0,
                            iter = 100000)

exploratory8a_bf <- bayesfactor_parameters(exploratory8a_bayesmodel,
                       prior=exploratory8a_priordraws, 
                       direction = "two-sided", 
                       parameters = "composite_political_orientation_z")
exploratory8b_bf <- bayesfactor_parameters(exploratory8b_bayesmodel,
                       prior=exploratory8b_priordraws, 
                       direction = "two-sided", 
                       parameters = "composite_political_orientation_z")
```
<br>
  
### Exploratory 8 Results: <span style="color:green">Ideology</span> predicts <span style="color:green">intergroup bias</span> in both samples, but the effect is greater in the <span style="color:green">Prolific</span> sample. 
```{r exploratory 8 results}
###FREQUENTIST
##Prolific Sample
summary(exploratory8a_freqmodel)

##MTurk Sample
summary(exploratory8b_freqmodel)

###BAYESIAN
##Prolific Sample
summary(exploratory8a_bayesmodel)
exploratory8a_bf

##MTurk Sample
summary(exploratory8b_bayesmodel)
exploratory8b_bf
```